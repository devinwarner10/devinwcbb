v[i] <- s_n(i)
}
v
m <- 50
s_n <- function(n){
n*(n+1)/2
}
v <- (length = m)
for(i in 1:m){
v[i] <- s_n(i)
}
v
plot(v)
for(i in 1:m){
v[i] <- s_n(i)
}
n <- 1:m
plot(n, v)
lines(n, sum(1:n))
for(i in 1:m){
v[i] <- s_n(i)
}
n <- 1:m
plot(n, v)
lines(n, n*(n+1)/2)
help(identical)
library(tidyverse)
library(dslabs)
library(dplyr)
data(murders)
hist(murders$total)
data.frame(State = murders$abb, Murder_Rate = (murders$total/murders$population)*10000)
murder_rate <- (murders$total/murders$population)*10000
murders
murder_rate <- (murders$total/murders$population)*1000
data.frame(State = murders$abb, Murder_Rate = murder_rate)
hist(murder_rate)
murders
hist(murders$total)
murder_rate <- murders$total / murders$population *10000
hist(murder_rate)
netflix
Netflix <- read.csv("/Users/devinwarner/Desktop/Kaggle/netflix_titles.
Netflix <- read.csv("/Users/devinwarner/Desktop/Kaggle/netflix_titles.
Netflix <- read.csv("/Users/devinwarner/Desktop/Kaggle/netflix_titles
Netflix <- read.csv("/Users/devinwarner/Desktop/Kaggle/netflix_titles
Netflix <- read.csv("/Users/devinwarner/Desktop/Kaggle/netflix_titles)
group1 = c(6,7,7,9,11,12,13,15)
group2 = c(9,10,10,12,13,16,19,20)
group3 = c(12,12,16,18,19,21,21,22)
groups = data.frame(cbind(group1, group2, group3))
groups
groups_stacked = stack(groups)
groups_stacked
anova_results = aov(values~ind, data=groups_stacked)
summary(anova_results)
1 + 1
print "Hello World"
5 % 2
5%2
getwd()
barplot(t(data),
main = "Proportion Accepted into Grad Programs",
xlab = "Graduate Program", ylab = "Proportion",
col = c("Blue", "Red"),
ylim=c(-.05,1.05),
legend.text = colnames(data),
beside = TRUE) # Grouped bars
library(ggplot2)
men_accepted <- c(511,352,129,137,53,22)
men_denied <- c(314,208,205,270,138,351)
women_accepted <- c(89,17,202,132,95,24)
women_denied <- c(19,8,391,243,298,317)
programs <- c('A', 'B', 'C', 'D', 'E','F')
prop_men_accepted <- men_accepted / (men_accepted + men_denied)
prop_women_accepted <- women_accepted / (women_accepted + women_denied)
names(prop_men_accepted) <- programs
names(prop_women_accepted) <- programs
prop_men_accepted
prop_women_accepted
data <- data.frame(prop_men_accepted, prop_women_accepted)
barplot(t(data),
main = "Proportion Accepted into Grad Programs",
xlab = "Graduate Program", ylab = "Proportion",
col = c("Blue", "Red"),
ylim=c(-.05,1.05),
legend.text = colnames(data),
beside = TRUE) # Grouped bars
install.packages("~/Desktop/github/dshw/Homework_2/devinwcbb")
library(devinwcbb)
run_cbb_shiny()
library(tidyverse)
library(lubridate)
library(shiny)
run_cbb_shiny()
# data <- get_cbb_data()
ui <- fluidPage(
titlePanel("College Basketball Data"),
sidebarLayout(
sidebarPanel(
selectInput('team', 'Teams', team_list(data),
selected = "Southern Utah")
),
mainPanel(
plotOutput("plot1"),
textOutput("text1"),
dataTableOutput("table1")
)
)
)
server <- function(input, output, session) {
team <- reactive({input$team})
output$text1 <- renderPrint({
team_win_record(data,team(),1)
})
output$plot1 <- renderPlot({
bbgraph(data, team())
})
output$table1 <- renderDataTable({
team_filter(data, team())
})
}
shinyApp(ui = ui, server = server)
data <- get_cbb_data()
# data <- get_cbb_data()
ui <- fluidPage(
titlePanel("College Basketball Data"),
sidebarLayout(
sidebarPanel(
selectInput('team', 'Teams', team_list(data),
selected = "Southern Utah")
),
mainPanel(
plotOutput("plot1"),
textOutput("text1"),
dataTableOutput("table1")
)
)
)
server <- function(input, output, session) {
team <- reactive({input$team})
output$text1 <- renderPrint({
team_win_record(data,team(),1)
})
output$plot1 <- renderPlot({
bbgraph(data, team())
})
output$table1 <- renderDataTable({
team_filter(data, team())
})
}
shinyApp(ui = ui, server = server)
setwd("~/Desktop/github/devinwcbb/")
devtools::install()
library(devinwcbb)
run_cbb_shiny()
setwd("R")
run_cbb_shiny()
get_cbb_data <- function() {
data <- read_fwf(file = url("http://kenpom.com/cbbga22.txt"), col_positions = fwf_widths(c(11, 23, 4, 23, 4, 3, 22), c("date", "home", "score1", "vis", "score2", "ufo1", "ufo2")), col_types = "ccicicc")
data <- data %>%
mutate(location = home) %>%
mutate(score_diff = score1 - score2) %>%
select(-c(6, 7))
data$date <- mdy(data$date)
team_id <- read_csv("MTeams.csv")
team_conf <- read_csv("MTeamConferences.csv") %>%
filter(Season == 2022)
conf_names <- read_csv("Conferences.csv")
data
}
setwd("~/Desktop/github/devinwcbb/")
devtools::uninstall()
get_cbb_data <- function() {
data <- read_fwf(file = url("http://kenpom.com/cbbga22.txt"), col_positions = fwf_widths(c(11, 23, 4, 23, 4, 3, 22), c("date", "home", "score1", "vis", "score2", "ufo1", "ufo2")), col_types = "ccicicc")
data <- data %>%
mutate(location = home) %>%
mutate(score_diff = score1 - score2) %>%
select(-c(6, 7))
data$date <- mdy(data$date)
team_id <- read_csv("MTeams.csv")
team_conf <- read_csv("MTeamConferences.csv") %>%
filter(Season == 2022)
conf_names <- read_csv("Conferences.csv")
data
}
get_cbb_data()
setwd("R")
get_cbb_data()
team_id <- read_csv("MTeams.csv")
team_conf <- read_csv("MTeamConferences.csv") %>%
filter(Season == 2022)
conf_names <- read_csv("Conferences.csv")
View(conf_names)
View(team_conf)
View(team_id)
?merge
step1 <- merge(x = team_conf, y = conf_nams, by = "ConfAbbrev")
step1 <- merge(x = team_conf, y = conf_names, by = "ConfAbbrev")
View(step1)
step1 <- merge(x = team_conf, y = conf_names, by = "ConfAbbrev", all.x = TRUE)
step2 <- mergre(x = team_id, y = step1, by = "TeamID", all.x = TRUE)
step2 <- merge(x = team_id, y = step1, by = "TeamID", all.x = TRUE)
View(step2)
step3 <- select(step2, c("TeamName", "conference" = "Description"))
View(step3)
View(data)
data <- merge(x = data, y = step3, by.x = "home", by.y = "TeamName", all.x = TRUE)
get_cbb_data <- function() {
data <- read_fwf(file = url("http://kenpom.com/cbbga22.txt"), col_positions = fwf_widths(c(11, 23, 4, 23, 4, 3, 22), c("date", "home", "score1", "vis", "score2", "ufo1", "ufo2")), col_types = "ccicicc")
data <- data %>%
mutate(location = home) %>%
mutate(score_diff = score1 - score2) %>%
select(-c(6, 7))
data$date <- mdy(data$date)
team_id <- read_csv("MTeams.csv")
team_conf <- read_csv("MTeamConferences.csv") %>%
filter(Season == 2022)
conf_names <- read_csv("Conferences.csv")
step1 <- merge(x = team_conf, y = conf_names, by = "ConfAbbrev", all.x = TRUE)
step2 <- merge(x = team_id, y = step1, by = "TeamID", all.x = TRUE)
step3 <- select(step2, c("TeamName", "conference" = "Description"))
data <- merge(x = data, y = step3, by.x = "home", by.y = "TeamName", all.x = TRUE) %>%
rename(conference = "home_conference") %>%
merge(x = data, y = step3, by.x = "vis", by.y = "TeamName", all.x = TRUE) %>%
rename(conference = "vis_conference")
data
}
data <- get_cbb_data()
get_cbb_data <- function() {
data <- read_fwf(file = url("http://kenpom.com/cbbga22.txt"), col_positions = fwf_widths(c(11, 23, 4, 23, 4, 3, 22), c("date", "home", "score1", "vis", "score2", "ufo1", "ufo2")), col_types = "ccicicc")
data <- data %>%
mutate(location = home) %>%
mutate(score_diff = score1 - score2) %>%
select(-c(6, 7))
data$date <- mdy(data$date)
team_id <- read_csv("MTeams.csv")
team_conf <- read_csv("MTeamConferences.csv") %>%
filter(Season == 2022)
conf_names <- read_csv("Conferences.csv")
step1 <- merge(x = team_conf, y = conf_names, by = "ConfAbbrev", all.x = TRUE)
step2 <- merge(x = team_id, y = step1, by = "TeamID", all.x = TRUE)
step3 <- select(step2, c("TeamName", "conference" = "Description"))
data <- merge(x = data, y = step3, by.x = "home", by.y = "TeamName", all.x = TRUE) %>%
rename(conference = "home_conference") %>%
merge(x = data, y = step3, by.x = "vis", by.y = "TeamName", all.x = TRUE) %>%
data
}
data <- get_cbb_data()
get_cbb_data <- function() {
data <- read_fwf(file = url("http://kenpom.com/cbbga22.txt"), col_positions = fwf_widths(c(11, 23, 4, 23, 4, 3, 22), c("date", "home", "score1", "vis", "score2", "ufo1", "ufo2")), col_types = "ccicicc")
data <- data %>%
mutate(location = home) %>%
mutate(score_diff = score1 - score2) %>%
select(-c(6, 7))
data$date <- mdy(data$date)
team_id <- read_csv("MTeams.csv")
team_conf <- read_csv("MTeamConferences.csv") %>%
filter(Season == 2022)
conf_names <- read_csv("Conferences.csv")
step1 <- merge(x = team_conf, y = conf_names, by = "ConfAbbrev", all.x = TRUE)
step2 <- merge(x = team_id, y = step1, by = "TeamID", all.x = TRUE)
step3 <- select(step2, c("TeamName", "conference" = "Description"))
data <- merge(x = data, y = step3, by.x = "home", by.y = "TeamName", all.x = TRUE) %>%
rename(conference = "home_conference") %>%
merge(x = data, y = step3, by.x = "vis", by.y = "TeamName", all.x = TRUE)
data
}
data <- get_cbb_data()
head(data)
get_cbb_data <- function() {
data <- read_fwf(file = url("http://kenpom.com/cbbga22.txt"), col_positions = fwf_widths(c(11, 23, 4, 23, 4, 3, 22), c("date", "home", "score1", "vis", "score2", "ufo1", "ufo2")), col_types = "ccicicc")
data <- data %>%
mutate(location = home) %>%
mutate(score_diff = score1 - score2) %>%
select(-c(6, 7))
data$date <- mdy(data$date)
team_id <- read_csv("MTeams.csv")
team_conf <- read_csv("MTeamConferences.csv") %>%
filter(Season == 2022)
conf_names <- read_csv("Conferences.csv")
step1 <- merge(x = team_conf, y = conf_names, by = "ConfAbbrev", all.x = TRUE)
step2 <- merge(x = team_id, y = step1, by = "TeamID", all.x = TRUE)
step3 <- select(step2, c("TeamName", "conference" = "Description"))
data <- merge(x = data, y = step3, by.x = "home", by.y = "TeamName", all.x = TRUE) %>%
rename(conference = "home_conference") %>%
merge(x = data, y = step3, by.x = "vis", by.y = "TeamName", all.x = TRUE)
data %>% arrage(date)
}
data <- get_cbb_data()
get_cbb_data <- function() {
data <- read_fwf(file = url("http://kenpom.com/cbbga22.txt"), col_positions = fwf_widths(c(11, 23, 4, 23, 4, 3, 22), c("date", "home", "score1", "vis", "score2", "ufo1", "ufo2")), col_types = "ccicicc")
data <- data %>%
mutate(location = home) %>%
mutate(score_diff = score1 - score2) %>%
select(-c(6, 7))
data$date <- mdy(data$date)
team_id <- read_csv("MTeams.csv")
team_conf <- read_csv("MTeamConferences.csv") %>%
filter(Season == 2022)
conf_names <- read_csv("Conferences.csv")
step1 <- merge(x = team_conf, y = conf_names, by = "ConfAbbrev", all.x = TRUE)
step2 <- merge(x = team_id, y = step1, by = "TeamID", all.x = TRUE)
step3 <- select(step2, c("TeamName", "conference" = "Description"))
data <- merge(x = data, y = step3, by.x = "home", by.y = "TeamName", all.x = TRUE) %>%
rename(conference = "home_conference") %>%
merge(x = data, y = step3, by.x = "vis", by.y = "TeamName", all.x = TRUE)
data %>% arrange(date)
}
data <- get_cbb_data()
head(data)
step1 <- merge(x = team_conf, y = conf_names, by = "ConfAbbrev", all.x = TRUE)
step2 <- merge(x = team_id, y = step1, by = "TeamID", all.x = TRUE)
step3 <- select(step2, c("TeamName", "conference" = "Description"))
team_id <- read_csv("MTeams.csv")
team_conf <- read_csv("MTeamConferences.csv") %>%
filter(Season == 2022)
conf_names <- read_csv("Conferences.csv")
step1 <- merge(x = team_conf, y = conf_names, by = "ConfAbbrev", all.x = TRUE)
step2 <- merge(x = team_id, y = step1, by = "TeamID", all.x = TRUE)
step3 <- select(step2, c("TeamName", "conference" = "Description"))
View(step3)
data <- read_fwf(file = url("http://kenpom.com/cbbga22.txt"), col_positions = fwf_widths(c(11, 23, 4, 23, 4, 3, 22), c("date", "home", "score1", "vis", "score2", "ufo1", "ufo2")), col_types = "ccicicc")
data <- data %>%
mutate(location = home) %>%
mutate(score_diff = score1 - score2) %>%
select(-c(6, 7))
data$date <- mdy(data$date)
data <- merge(x = data, y = step3, by.x = "home", by.y = "TeamName", all.x = TRUE) %>%
data
data <- read_fwf(file = url("http://kenpom.com/cbbga22.txt"), col_positions = fwf_widths(c(11, 23, 4, 23, 4, 3, 22), c("date", "home", "score1", "vis", "score2", "ufo1", "ufo2")), col_types = "ccicicc")
data <- data %>%
mutate(location = home) %>%
mutate(score_diff = score1 - score2) %>%
select(-c(6, 7))
head(data)
data$date <- mdy(data$date)
head(data)
data <- merge(x = data, y = step3, by.x = "home", by.y = "TeamName", all.x = TRUE)
head(data)
head(data %>% arrange(date))
data <- merge(x = data, y = step3, by.x = "home", by.y = "TeamName", all.x = TRUE) %>%
rename(conference = "home_conference")
data <- merge(x = data, y = step3, by.x = "home", by.y = "TeamName", all.x = TRUE) %>%
rename(home_conference = conference)
data <- merge(x = data, y = step3, by.x = "home", by.y = "TeamName", all.x = TRUE) %>%
rename(home_conference = conference)
data <- merge(x = data, y = step3, by.x = "home", by.y = "TeamName", all.x = TRUE) %>%
rename(home_conference = "conference")
data <- merge(x = data, y = step3, by.x = "home", by.y = "TeamName", all.x = TRUE) %>%
rename("home_conference" = conference)
names(data)
rename(data, home_conference = conference)
data <- merge(x = data, y = step3, by.x = "home", by.y = "TeamName", all.x = TRUE)
data <- rename(data, home_conference = conference)
data <- merge(x = data, y = step3, by.x = "vis", by.y = "TeamName", all.x = TRUE)
data <- merge(x = data, y = step3, by.x = "home", by.y = "TeamName", all.x = TRUE)
data <- read_fwf(file = url("http://kenpom.com/cbbga22.txt"), col_positions = fwf_widths(c(11, 23, 4, 23, 4, 3, 22), c("date", "home", "score1", "vis", "score2", "ufo1", "ufo2")), col_types = "ccicicc")
data <- merge(x = data, y = step3, by.x = "home", by.y = "TeamName", all.x = TRUE)
data <- rename(data, home_conference = conference)
data <- merge(x = data, y = step3, by.x = "vis", by.y = "TeamName", all.x = TRUE)
data <- rename(data, vis_conference = conference)
head(data)
conf_names$Description %>%
str_replace_all(' Conference', '') ->
conf_names$Description
step1 <- merge(x = team_conf, y = conf_names, by = "ConfAbbrev", all.x = TRUE)
step2 <- merge(x = team_id, y = step1, by = "TeamID", all.x = TRUE)
step3 <- select(step2, c("TeamName", "conference" = "Description"))
View(step3)
data <- merge(x = data, y = step3, by.x = "home", by.y = "TeamName", all.x = TRUE)
data <- rename(data, home_conference = conference)
data <- merge(x = data, y = step3, by.x = "vis", by.y = "TeamName", all.x = TRUE)
data <- rename(data, vis_conference = conference)
data <- read_fwf(file = url("http://kenpom.com/cbbga22.txt"), col_positions = fwf_widths(c(11, 23, 4, 23, 4, 3, 22), c("date", "home", "score1", "vis", "score2", "ufo1", "ufo2")), col_types = "ccicicc")
data <- data %>%
mutate(location = home) %>%
mutate(score_diff = score1 - score2) %>%
select(-c(6, 7))
data$date <- mdy(data$date)
team_id <- read_csv("MTeams.csv")
team_conf <- read_csv("MTeamConferences.csv") %>%
filter(Season == 2022)
conf_names <- read_csv("Conferences.csv")
conf_names$Description %>%
str_replace_all(' Conference', '') ->
conf_names$Description
step1 <- merge(x = team_conf, y = conf_names, by = "ConfAbbrev", all.x = TRUE)
step2 <- merge(x = team_id, y = step1, by = "TeamID", all.x = TRUE)
step3 <- select(step2, c("TeamName", "conference" = "Description"))
data <- merge(x = data, y = step3, by.x = "home", by.y = "TeamName", all.x = TRUE)
data <- rename(data, home_conference = conference)
data <- merge(x = data, y = step3, by.x = "vis", by.y = "TeamName", all.x = TRUE)
data <- rename(data, vis_conference = conference)
head(data %>% arrange(date), 25)
data <- arrange(data, date) %>% select(c("date", "home", "score1","vis", "score2",
"location", "score_diff", "home_conference",
"vis_conference"))
head(data)
data %>%
filter(home_conference == vis_conference)  %>%
select(c("date", "home", "score1","vis", "score2",
"location", "score_diff", "home_conference")) %>%
rename(conference = home_conference)
setwd("~/Desktop/github/devinwcbb")
devtools::install()
devtools::uninstall()
devtools::install()
devtools::install()
devtools::install()
library(devinwcbb)
run_cbb_shiny()
devtools::uninstall()
devtools::install()
library(devinwcbb)
run_cbb_shiny()
devtools::uninstall()
devtools::install()
library(devinwcbb)
run_cbb_shiny()
.rs.restartR()
devtools::uninstall()
devtools::install()
library(devinwcbb)
run_cbb_shiny()
devtools::uninstall()
devtools::document()
devtools::document()
rs.restartR
.rs.restartR()
devtools::document()
devtools::install()
devtools::uninstall()
devtools::document()
devtools::install()
library(devinwcbb)
run_cbb_shiny()
conf_data <- get_cbb_data(1)
data <- get_cbb_data(0)
head(conf_data)
all_teams_records <- function(data) {
team_names <- team_list(data)
teams_tibble <- tibble(team = character(), wins = integer(), total_games = integer(),
win_percentage = numeric())
for (i in 1:nrow(team_names)) {
x <- pull(team_names)[i]
X <- team_win_record(data,x)
teams_tibble <- teams_tibble %>%
add_row(team = x, wins = X[1], total_games = X[2],
win_percentage = X[3])
}
avg_win_perc <- mean(teams_tibble$win_percentage)
teams_tibble %>%
mutate("weighted_wins" = (wins^2 ) / (total_games) ) %>%
arrange(-weighted_wins)
}
team_list <- function(data){
tibble(team = append(data$home, data$vis)) %>% distinct()
}
devtools::uninstall()
all_teams_records(conf_data)
team_win_record <- function(data, team, text = 0) {
x <- team_filter(data,team)
tot_games <- x %>%
summarise(n = n()) %>%
pull()
wins <- sum(ifelse(x$scoredifference > 0, 1, 0))
if (text == 1) {
cat(team, "has won", wins, "of their", tot_games, "games, for a win percentage of", round(wins / tot_games * 100, digits = 2), "%. \n")
} else {
c(wins, tot_games, round(wins / tot_games * 100, 2))
}
}
all_teams_records(conf_data)
#'
#' @return tibble
#'
#' @export
#'
#' @examples
#' team_filter(get_cbb_data(), "Southern Utah")
#' team_filter(get_cbb_data(), "Northern Arizona")
#'
#'
team_filter <- function(data, team) {
x <- filter(data, home == team | vis == team)
x$opponent <- ifelse(x$home == team, x$vis, x$home)
x$teamscore <- ifelse(x$home == team, x$score1, x$score2)
x$opponentscore <- ifelse(x$home == team, x$score2, x$score1)
x$scoredifference <- x$teamscore - x$opponentscore
x$result <- ifelse(x$scoredifference > 0, "Win", "Loss")
x[,c("date","opponent", "teamscore", "opponentscore", "location", "scoredifference", "result")]
}
all_teams_records(conf_data)
all_teams_records(conf_data %>% conference == 'Big Sky')
all_teams_records(conf_data %>% filter(conference == 'Big Sky'))
devtools::uninstall()
devtools::install()
library(devinwcbb)
run_cbb_shiny()
devtools::uninstall()
devtools::install()
library(devinwcbb)
run_cbb_shiny()
devtools::uninstall()
devtools::install()
library(devinwcbb)
run_cbb_shiny()
devtools::uninstall()
devtools::install()
library(devinwcbb)
run_cbb_shiny()
